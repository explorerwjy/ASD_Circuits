# Configuration for Sibling Null Circuit Search - Random (Uniform) Model
#
# Usage:
#   snakemake -s Snakefile.circuit.sibling \
#       --configfile config/circuit_config_sibling_random.yaml --cores 10
#
#   # Test with 5 siblings:
#   snakemake -s Snakefile.circuit.sibling \
#       --configfile config/circuit_config_sibling_random.yaml \
#       --config n_sibling=5 --cores 10 -n

# ============================================================================
# Sibling Configuration
# ============================================================================

sibling_mode: true

# Parquet file with all sibling bias data (generated by generate_sibling_bias_files.py)
# Format: (N_structures x N_sims), same as existing null bias parquets
sibling_bias_parquet: "results/Sibling_bias/Random_61gene/sibling_random_bias.parquet"

# Reference bias for rank-based alignment ("bias transfer").
# Sibling structures ranked by sibling bias get EFFECT values from this
# reference at the same rank.  SA search uses transferred values;
# real sibling bias is recalculated during aggregation.
# Change this to align siblings to a different test dataset (e.g., SCZ).
reference_bias_df: "dat/Unionize_bias/Spark_Meta_EWS.Z2.bias.FDR.csv"

# Prefix for dataset names
sibling_dataset_prefix: "ASD_Sib_Random_"

# Number of sibling simulations to run (null = use all in NPZ)
n_sibling: 1000

# ============================================================================
# Main Dataset (for comparison)
# ============================================================================

include_main_dataset: true

Input_str_bias:
  ASD_Main:
    name: "ASD_SPARK_Main"
    bias_df: "dat/Unionize_bias/Spark_Meta_EWS.Z2.bias.FDR.csv"
    description: "Main ASD SPARK result (for comparison with sibling null)"

# ============================================================================
# Connectivity Matrices
# ============================================================================

weight_mat: "dat/allen-mouse-conn/ConnectomeScoringMat/WeightMat.Ipsi.csv"
info_mat: "dat/allen-mouse-conn/ConnectomeScoringMat/InfoMat.Ipsi.csv"

# ============================================================================
# Output Configuration
# ============================================================================

output_dir: "results/CircuitSearch_Sibling_Random"

# ============================================================================
# Circuit Search Parameters (reduced for null â€” 10K samples compensate)
# ============================================================================

circuit_sizes:
  - 46

top_n: 213

min_bias_rank: 50

# SA runs per bias limit (default for sibling datasets)
sa_runtimes: 5

# SA runs for main dataset (more runs for higher-quality Pareto front)
main_sa_runtimes: 20

sa_steps: 50000

measure: "SI"

n_cores: 10

verbose: False

# ============================================================================
# Aggregation Settings
# ============================================================================

ci_level: 0.95

aggregation_output_dir: "results/CircuitSearch_Sibling_Summary/Random"

# ============================================================================
# Bias Generation Settings (used by generate_sibling_bias_files.py)
# ============================================================================

expr_matrix: "dat/BiasMatrices/AllenMouseBrain_Z2bias.parquet"
gene_weights: "dat/Genetics/GeneWeights/ASD_All.gw"
sibling_pool: "dat/Genetics/GeneWeights/sibling_weights_LGD_Dmis.csv"
gene_prob: null     # not needed for random model
n_sims: 10000
base_seed: 20260210
