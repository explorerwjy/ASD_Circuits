# List of gene sets to analyze
ProjDIR: "/home/jw3514/Work/ASD_Circuits_CellType/"  # Change to your project directory

gene_sets:
  ASD_All:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/Spark_Meta_EWS.gw"
    null_model: "mutability"
  ASD_HIQ:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/ASD.HIQ.gw.csv"
    null_model: "mutability"
  ASD_LIQ:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/ASD.LIQ.gw.csv"
    null_model: "mutability"
  ASD_SPARK_159:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/Spark_Meta_160.GeneWeight.csv"
    null_model: "mutability"
  DDD_61:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/DDD.top61.gw"
    null_model: "mutability"
  DDD_293:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/DDD.top293.gw"
    null_model: "mutability"
  DDD_293_ExcludeASD:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/DDD.top293.ExcludeASD.gw"
    null_model: "mutability"
  ASC_102:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/GW_ASC_102.gw"
    null_model: "mutability"
  Spark_top20:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/Spark_top20.gw"
    null_model: "mutability"
  Fu_ASD_72:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/GW_Fu_ASD_72.gw"
    null_model: "mutability"
  Fu_ASD_185:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/GW_Fu_ASD_185.gw"
    null_model: "mutability"
  SCZ:
    geneweights: "/home/jw3514/Work/CellType_Psy/CellTypeBias_VIP/dat/GeneWeights/SCZ.top61.nopLI.LGD_Dmis_SameWeight.exclude_Mis2.gw"
    null_model: "mutability"

  # Constraint_top_decile_LOEUF:
  #   geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/constraint_top_decile_LOEUF.gw"
  # Constraint_top_decile_LOEUF_excludeASD:
  #   geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/constraint_top_decile_LOEUF_excludeASD.gw"
  Constraint_top25_LOEUF:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/constraint_top25_LOEUF.gw"

  NT_Dopamine_source:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_dopamine_source.gw"
  NT_Dopamine_target:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_dopamine_target.gw"
  NT_Dopamine_combined:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_dopamine_combined.gw"
  
  NT_Serotonin_source:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_serotonin_source.gw"
  NT_Serotonin_target:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_serotonin_target.gw"
  NT_Serotonin_combined:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_serotonin_combined.gw"
  
  NT_Oxytocin_source:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_oxytocin_source.gw"
  NT_Oxytocin_target:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_oxytocin_target.gw"
  NT_Oxytocin_combined:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_oxytocin_combined.gw"

  NT_acetylcholine_source:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_acetylcholine_source.gw"
  NT_acetylcholine_target:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_acetylcholine_target.gw"
  NT_acetylcholine_combined:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/NT_acetylcholine_combined.gw"

  Parkinson:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/Parkinson.top61.gw"
  Alzheimer:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/ALZ.top60.gw"
  hba1c:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/hba1c.top61.gw"
  HDL_C:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/HDL_C.top61.gw"
  IBD:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/IBD.top61.gw"
  T2D:
    geneweights: "/home/jw3514/Work/ASD_Circuits_CellType/dat/Genetics/GeneWeights/T2D.top61.gw"
# Analysis types and their corresponding expression matrices and modes
analysis_types:
  STR_ISH:
    # Z2 (17,208 genes) from Jon's R log2+QN → Z1 → Z2.
    # Bit-exact CCS profile, local peak at size 46 confirmed.
    # See notebook_validation/Validate_ISH_Z2_Pipeline for details.
    expr_matrix: "dat/BiasMatrices/AllenMouseBrain_Z2bias.parquet"
    mode: "mouse_str_bias"
  # CT_Spec: 
  #   expr_matrix: "dat/BiasMatrices/MouseCT.TPM.1.Filt.Spec.clip.lowexp.100000.qn.parquet"
  #   mode: "mouse_ct_bias"
  # STR_MERIFH: 
  #   expr_matrix: "dat/BiasMatrices/MouseBrain_MERIFHbias.parquet"
  #   mode: "mouse_str_bias"
  CT_Z2: 
    expr_matrix: "dat/BiasMatrices/Cluster_Z2Mat_ISHMatch.z1clip3.parquet" 
    mode: "mouse_ct_bias"

# Output directory for all results
output_dir: "results"
# Number of random weights (can customize per gene set if needed)
n_random_weights: 10000

# Data file paths
data_files:
  # Allen Brain Atlas ISH expression data (structure-unionized, ~26K CSV files)
  ish_expression_dir: "/mnt/data0/AllenBrainAtlas/ISH"
  # Allen Brain Atlas metadata
  allen_metadata_dir: "dat/allen-mouse-exp"
  # Jon's raw expression energy matrix (arithmetic mean of raw, 17208 genes × 213 structures)
  jon_exp_raw: "dat/allen-mouse-exp/Jon_ExpMat.raw.csv"
  # Jon's R-generated log2+QN expression matrix (THE input for legacy Z2)
  jon_exp_log2_qn: "dat/allen-mouse-exp/Jon_ExpMat.log2.qn.csv"
  # Legacy Z1 reference (from Jon's QN data, used to compute legacy Z2)
  legacy_z1: "dat/allen-mouse-exp/AllenMouse_z1_mat.0511.csv"
  # Legacy expression match files (symlink to old project, 17189 files)
  legacy_match_dir: "dat/allen-mouse-exp/ExpMatch_Legacy"
  sibling_weights: "dat/Genetics/GeneWeights/sibling_weights_LGD_Dmis.csv"
  gene_prob: "dat/Genetics/GeneWeights/GeneProb_LGD_Dmis.csv"
  mouse_ct_annotation: "dat/MouseCT_Cluster_Anno.csv"
  cell_type_hierarchy: "dat/CellTypeHierarchy.csv"
  protein_coding_genes: "dat/Genetics/protein-coding_gene.txt"
  major_brain_divisions: "dat/structure2region.tsv"
  Denovo_mut_rate: "/home/jw3514/Work/Resources/MutationRate_20170710_rate.CorrectSymbol.txt"
  # Single-cell cluster-level expression matrices (Allen Brain Cell Atlas)
  cluster_mean_log_umi: "dat/SC_UMI_Mats/cluster_MeanLogUMI.parquet"
  cluster_mean_log_umi_csv: "dat/SC_UMI_Mats/cluster_MeanLogUMI.csv"
  cluster_expression_quantiles: "dat/SC_UMI_Mats/ABC_LogUMI.Match.10xV3.parquet"
  # MERFISH spatial transcriptomics data
  merfish_annotation: "dat/MERFISH/MERFISH.ISH_Annot.csv"
  merfish_annotation_parquet: "dat/MERFISH/MERFISH.ISH_Annot.parquet"
  merfish_ccf_ontology: "dat/MERFISH/CCF_V3_ISH_MERFISH.csv"
  # Structure-level bias (FDR-adjusted, used as ISH structure reference list)
  str_bias_fdr: "dat/Unionize_bias/Spark_Meta_EWS.Z2.bias.FDR.csv"
  asd_gene_weights_v2: "dat/Unionize_bias/Spark_Meta_EWS.GeneWeight.v2.csv"
  # MERFISH Z2 expression matrices (structure-level, ISH-matched)
  merfish_z2_cell_mean: "dat/MERFISH/STR_Cell_Mean_Z2Mat_ISHMatch.csv"
  merfish_z2_vol_mean: "dat/MERFISH/STR_Vol_Mean_Z2Mat_ISHMatch.csv"
  merfish_z2_neur_mean: "dat/MERFISH/STR_NEUR_Mean_Z2Mat_ISHMatch.csv"
  merfish_z2_neur_vol_mean: "dat/MERFISH/STR_NEUR_Vol_Mean_Z2Mat_ISHMatch.csv"
  # Cell-type bias with sibling-null p-values (produced by 05.Bias_Controls)
  ct_bias_addp: "notebooks_mouse_sc/dat/Bias/ASD.ClusterV3.top60.UMI.Z2.z1clip3.addP.csv"
  # ASD circuit (SA search result, Size 46 Pareto front index 3)
  asd_circuit_size46: "results/STR_ISH/ASD.SA.Circuits.Size46.csv"
  # Connectivity scoring matrices (InfoMat)
  infomat_ipsi: "dat/allen-mouse-conn/ConnectomeScoringMat/InfoMat.Ipsi.csv"
  infomat_ipsi_short: "dat/allen-mouse-conn/ConnectomeScoringMat/InfoMat.Ipsi.Short.3900.csv"
  infomat_ipsi_long: "dat/allen-mouse-conn/ConnectomeScoringMat/InfoMat.Ipsi.Long.3900.csv"
  # Null connectivity scores (RankScore permutations)
  rankscore_ipsi: "dat/allen-mouse-conn/RankScores/RankScore.Ipsi.Cont.npy"
  rankscore_ipsi_short: "dat/allen-mouse-conn/RankScores/RankScore.Ipsi.Short.3900.Cont.npy"
  rankscore_ipsi_long: "dat/allen-mouse-conn/RankScores/RankScore.Ipsi.Long.3900.Cont.npy"
  # ISH structure bias (without FDR)
  str_bias_raw: "dat/Unionize_bias/Spark_Meta_EWS.Z2.bias.csv"
  # MERFISH raw UMI expression matrices (structure-level, pre-normalization)
  merfish_cell_mean_umi: "dat/MERFISH/STR_Cell_Mean_DF.UMI.csv"
  merfish_vol_mean_umi: "dat/MERFISH/STR_Vol_Mean_DF.UMI.csv"
  merfish_neur_mean_umi: "dat/MERFISH/STR_NEU_Mean_DF.UMI.csv"
  merfish_neur_vol_mean_umi: "dat/MERFISH/STR_NEU_Vol_Mean_DF.UMI.csv"
  # Zhuang MERFISH dataset (optional)
  merfish_zhuang_cell_mean_umi: "dat/MERFISH_Zhuang/STR_Cell_Mean_DF.UMI.csv"
  merfish_zhuang_vol_mean_umi: "dat/MERFISH_Zhuang/STR_Vol_Mean_DF.UMI.csv"
  # Cell-type gene weights (DN = expressed in Allen ISH + matched gene set)
  asd_gene_weights_dn: "dat/Genetics/GeneWeights_DN/Spark_Meta_EWS.GeneWeight.DN.gw"
  ddd_gene_weights_dn: "dat/Genetics/GeneWeights_DN/DDD.top293.ExcludeASD.DN.gw"
  # MERFISH cells annotated with ASD bias (produced by 06.Bias_Display)
  merfish_cells_bias_annotated: "notebooks_mouse_sc/dat/MERFISH/MERFISH.cells.ASD.Bias.Anno.parquet"
  # Subclass expression matrices split by 10x chemistry (V2 vs V3, for DN weighting)
  subclass_v2_exp: "dat/ExpressionMats/Subclass_V2_ExpMat.csv"
  subclass_v3_exp: "dat/ExpressionMats/Subclass_V3_ExpMat.csv"
  # V2-V3 cross-platform gene correlation (ISH/MERFISH/V2/V3, cached)
  gene_cross_platform_corr: "dat/ISH_MERFISH_Gene_CorssSTR_Corr.v3.csv"
  # ISH log-mean expression (legacy, for correlation computation only)
  ish_log_mean_exp: "dat/allen-mouse-exp/JW_ExpMat.LogMean.0418.csv"
  # Z2 split files (external dependency, on data mount)
  z2_split_base: "/mnt/data0/home_backup/Work/CellType_Psy/AllenBrainCellAtlas/dat/Z2.Split"
